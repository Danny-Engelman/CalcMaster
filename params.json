{"name":"Calcmaster","tagline":"SharePoint Calculated Column Editor by ViewMaster365.com / 365coach.nl","body":"Drag [this CalcMaster Bookmarklet](javascript:void%20function(){(function(){for(var%20e,t=[%22assert%22,%22assert%22,%22cd%22,%22clear%22,%22count%22,%22countReset%22,%22debug%22,%22dir%22,%22dirxml%22,%22dirxml%22,%22dirxml%22,%22error%22,%22error%22,%22exception%22,%22group%22,%22group%22,%22groupCollapsed%22,%22groupCollapsed%22,%22groupEnd%22,%22info%22,%22info%22,%22log%22,%22log%22,%22markTimeline%22,%22profile%22,%22profileEnd%22,%22profileEnd%22,%22select%22,%22table%22,%22table%22,%22time%22,%22time%22,%22timeEnd%22,%22timeEnd%22,%22timeEnd%22,%22timeEnd%22,%22timeEnd%22,%22timeStamp%22,%22timeline%22,%22timelineEnd%22,%22trace%22,%22trace%22,%22trace%22,%22trace%22,%22trace%22,%22warn%22],a=t.length,n=window.console=window.console||{},o=function(){};a--;)e=t[a],n[e]||(n[e]=o)})(),void%200!==typeof%20_spPageContextInfo%26%26alert(%22Run%20the%20CalcMaster%20on%20a%20SharePoint%20page%20editing%20an%20existing%20Calculated%20Column%20Formula%22);var%20e={comma:1033===_spPageContextInfo.currentLanguage%3F%22,%22:%22;%22,layouts:_spPageContextInfo.layoutsUrl,saveID:0,initialize:function(){e.columnList=document.getElementById(%22onetidIOCalcFields1%22),e.textarea=document.getElementById(%22onetidIODefTextValue1%22),e.columnList.style.height=e.textarea.style.height=%22300px%22,e.textarea.style.width=%22500px%22,e.setDOMelement(%22Number%20(outputs%20HTML/JavaScript)%22,0,%22L_onetidTypeNumber1%22,%22lightGreen%22);var%20t=%22%3Cspan%20style='font-size:1.3em;'%3ECalcMaster%3C/span%3E%22;t+=%22powered%20by%20%3Ca%20target=_new%20href=http://365coach.nl%3E365Coach.nl%3C/a%3E%22,t+=%22%3Cbr%3EMIT%20sourcecode%20on%20%3Ca%20target=_new%20href=https://github.com/Danny-Engelman/CalcMaster%3EGitHub%3C/a%3E%22,t+=%22%3Cbr%3E%3Cbr%3ESee%20%3Ca%20href='http://viewmaster365.com/365coach/%23/Calculated_Column_Functions_List'%22,t+=%22target=_new%3ESharePoint%20Calculated%20Column%20Functions%20%26%20Syntax%20List%3C/a%3E%22,t+=%22%3Cbr%3EThe%22,t+=%22%3Ca%20href='http://viewmaster365.com/365coach/%23/Drag_Drop_Columns_in_the_EditView_Page'%3E%22,t+=%22Drag-Drop%20View%20Editor%3C/a%3E%20is%20a%20cool%20bookmarklet%20also%22,t+=%22%3Cdiv%20style='min-height:55px;max-width:500px;'%3E%22,t+=%22%3Cimg%20src='/%22+e.layouts+%22/images/WSC16.GIF'%22,t+=%22title='Wrap%20Javascript%20code%20in%20SharePoint%20Formula%20quoted%20string'%22,t+=%22onclick='VM365_CalcMaster.functionConvertToICC()'%3E%22,t+=%22%3Cdiv%20id='calcmasterSave'%3E%3C/div%3E%3Cdiv%20id='calcmasterHint'%3E%3C/div%3E%22,t+=%22%3C/div%3E%22,e.setDOMelement(t,0,%22onetidIODefText0%22),e.addFunctionlist(),e.setDOMelement(%22Update%20your%20Formula%20and%20I%20will%20check%20if%20the%20Formula%20is%20correct%22,2),e.textarea.onkeyup=function(t){-1===[37,38,39,40].indexOf(t.keyCode)%26%26(clearTimeout(e.saveID),e.saveID=setTimeout(function(){e.updateFormula(t)},300))}},setDOMelement:function(e,t,a,n){var%20o=document.getElementById(a||%22calcmasterSave%22);o.innerHTML=e,o.style.color=[%22black%22,%22red%22,%22green%22,%22darkorange%22][t],n%26%26(o.style.backgroundColor=n)},setFormulaInTextarea:function(t){-1===t.indexOf(%22\\n%22)%26%26(t=t.replace(/%26\\%22/gi,'\\n%20%20%26%22'),t=t.replace(/\\%22%26/gi,'%22\\n%20%20%26'),t=t.replace(/\\%22;/gi,'%22\\n;'),t=t.replace(/IF/g,%22\\nIF%22)),e.textarea.value=t},sanitizeFormulaBeforeWritingToSP:function(e){return%20e=e.replace(/`/g,%22'%22)},functionConvertToICC:function(t){t=t||e.textarea.value,%22=%22!==t[0]%3F(t.replace(/'/g,%22`%22),-1===t.indexOf(%22onload%22)%26%26-1===t.indexOf(%22onclick%22)%26%26(t='=%22%3Cimg%20src=/_layouts/images/blank.gif%20onload=%22%22{%22%26%22'+t.replace(/\\n/g,'%22\\n%26%22')+'%22%26%22}%22%22%3E%22'),e.setFormulaInTextarea(t),e.updateFormula()):e.setDOMelement(%22textarea%20does%20not%20contain%20plain%20JavaScript%22,1)},updateFormula:function(t){var%20a=Array.prototype.filter.call(document.getElementsByName(%22ResultType%22),function(e){return%20e.checked%3Fe:void%200}),n=e.textarea.value;e.setFormulaInTextarea(n),e.updateCalculatedColumn({Title:document.getElementById(%22idColName%22).value,Description:document.getElementById(%22idDesc%22).value,Formula:n,type:a[0].value});var%20o=[];n.split('%22').length%252===0%26%26o.push(%22unmatched%20double%20quotes%22),n.split(%22'%22).length%252===0%26%26o.push(%22unmatched%20single%20quotes%22),n.split(%22(%22).length!==n.split(%22)%22).length%26%26o.push(%22unmatched%20()%20brackets%22),e.setDOMelement(o.join(%22%3Cbr%3E%22),3,%22calcmasterHint%22)},updateCalculatedColumn:function(t,a,n,o){e.setDOMelement(%22Updating%20Formula%20%22+t.Title+%22...%20%3Cspan%20style='color:gray'%3E(this%20may%20take%20a%20minute)%3C/span%3E%22,2),t.list=%22Lists(guid'%22+_spPageContextInfo.pageListId.replace(/[{}]/g,%22%22)+%22')%22,t.field=%22Fields/getbytitle('%22+t.Title+%22')%22;var%20i=new%20XMLHttpRequest;i.onreadystatechange=function(){console.info(i.status,i),e.setDOMelement(%22Updating%20all%20List%20Items...%22),i.readyState==XMLHttpRequest.DONE%26%26(500==i.status%3F(console.info(i.status,i.statusText,JSON.parse(i.responseText).error.message.value),e.setDOMelement(JSON.parse(i.responseText).error.message.value,1)):e.setDOMelement(%22Formula%20%22+t.Title+%22%20saved!%22))},console.info(%22saving%22,t.Title,t.Formula),i.open(%22POST%22,_spPageContextInfo.webAbsoluteUrl+%22/_api/Web/%20%22+t.list+%22/%22+t.field,!0),i.setRequestHeader(%22X-HTTP-Method%22,%22MERGE%22),i.setRequestHeader(%22X-RequestDigest%22,document.getElementById(%22__REQUESTDIGEST%22).value),i.setRequestHeader(%22accept%22,%22application/json;odata=verbose%22),i.setRequestHeader(%22content-type%22,%22application/json;odata=verbose%22),i.send(JSON.stringify({Title:t.Title,Formula:e.sanitizeFormulaBeforeWritingToSP(t.Formula),__metadata:{type:%22SP.FieldCalculated%22},Description:t.Description,OutputType:{Text:2,Number:9,Currency:10,DateTime:4,Boolean:8}[t.type]}))},JQ_updateCalculatedColumn:function(t){e.setDOMelement(%22Updating%20Formula%20%22+t.Title+%22...%20%3Cspan%20style='color:gray'%3E(this%20may%20take%20a%20minute)%3C/span%3E%22,2),t.list=%22Lists(guid'%22+_spPageContextInfo.pageListId.replace(/[{}]/g,%22%22)+%22')%22,t.field=%22Fields/getbytitle('%22+t.Title+%22')%22,$.ajax({url:_spPageContextInfo.webAbsoluteUrl+%22/_api/Web/%20%22+t.list+%22/%22+t.field,success:function(a){e.setDOMelement(%22Formula%20%22+t.Title+%22%20saved%20succesfully%22)},error:function(t){e.setDOMelement(t.responseJSON.error.message.value,1)},type:%22POST%22,headers:{%22X-HTTP-Method%22:%22MERGE%22,%22X-RequestDigest%22:document.getElementById(%22__REQUESTDIGEST%22).value,accept:%22application/json;odata=verbose%22,%22content-type%22:%22application/json;odata=verbose%22},data:JSON.stringify({Title:t.Title,Formula:e.sanitizeFormulaBeforeWritingToSP(t.Formula),__metadata:{type:%22SP.FieldCalculated%22},Description:t.Description,OutputType:{Text:2,Number:9,Currency:10,DateTime:4,Boolean:8}[t.type]})})},addFunctionlist:function(){var%20e=document.getElementById(%22onetidIODefText0%22).parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.cells[1];e.style.verticalAlign=%22top%22,e.style.width=%22inherit%22,e.innerHTML=%22%22}};e.initialize()}();)\r\n","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}